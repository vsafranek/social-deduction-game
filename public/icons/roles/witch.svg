<svg width="512" height="512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
  <!-- Background circle -->
  <circle id="bg" data-part="bg" cx="256" cy="256" r="240" fill="#111822" />
  <circle id="bgInner" data-part="bgInner" cx="256" cy="256" r="208" fill="#182334" />

  <!-- Magic Sparkles (Background) - Adjusted positions slightly to frame the lower hat -->
  <path data-part="sparkle" d="M150 180 L165 150 L180 180 L165 210 Z" fill="#E040FB" opacity="0.8" />
  <circle data-part="sparkle" cx="350" cy="130" r="5" fill="#E040FB" opacity="0.6" />

  <!-- The Witch Hat Group (Moved Down) -->
  <g id="hat" transform="translate(256, 310)"> <!-- Moved from 280 to 310 -->

      <!-- Brim -->
      <ellipse data-part="brim" cx="0" cy="0" rx="160" ry="40" fill="#6200EA" stroke="#4A148C" stroke-width="4" />

      <!-- The Crown (Cone) -->
      <path data-part="crown" d="M-80 0 L-10 -220 L10 -220 L80 0 Z" fill="#6200EA" stroke="#4A148C" stroke-width="4" stroke-linejoin="round" />

      <!-- The Band -->
      <path data-part="band" d="M-72 -10 L-62 -40 L62 -40 L72 -10" fill="#AA00FF" stroke="#7B1FA2" stroke-width="2" />

      <!-- The Buckle -->
      <g data-part="buckle" transform="translate(0, -25)">
          <rect x="-25" y="-15" width="50" height="30" rx="4" fill="none" stroke="#FFD600" stroke-width="6" />
          <path d="M0 -15 V15" stroke="#FFD600" stroke-width="4" />
      </g>

      <path data-part="brimShadow" d="M-160 0 A160 40 0 0 0 160 0" fill="none" stroke="#4A148C" stroke-width="2" opacity="0.3" />

  </g>

  <!-- Magic Orbs/Sparkles (Foreground) - Adjusted to follow the hat -->
  <path data-part="sparkle" d="M380 250 L395 220 L410 250 L395 280 Z" fill="#E040FB" opacity="0.9" />
  <circle data-part="orb" cx="220" cy="330" r="10" fill="#E1BEE7" opacity="0.8" />
  <circle data-part="orb" cx="300" cy="320" r="8" fill="#E1BEE7" opacity="0.6" />
  <circle data-part="orb" cx="260" cy="300" r="12" fill="#E1BEE7" opacity="0.4" />

</svg>